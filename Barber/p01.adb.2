--with  Gnat.IO;
with Text_Io;

procedure P01 is 
   --use Ada.Text_IO;
   use Text_Io;

   
   ------------------------------------------------------------------------------
   task Barber is
      entry wake;
            --entry B (data : out integer);
            
   end Barber;


   task body Barber is
      State: integer;
            lmtx : integer = 0;      
   begin
            
      loop  

            Bshop.berber_work;

           
      
      end loop;
   end Barber;
   ------------------
   
   task type Client is
      entry done;
            --entry B (data : out integer);            
   end Client ;


   task body Client is
      L: integer;
   begin
         loop
      bShop.client_work;

         end loop;
   end Client ;
      
      T_1 : T;
      T_2 : T;
  ----------------------   
  
   task type BShop is
      entry done;
      entry check;            
   end BShop;


   task body BShop is
      is_Sleep: boolean = true;
            is_done: boolean = false;
            is_in:boolean = false;
   begin
      
           loop
              
              accept client_work do
              
              end client_work;
              
              accept barber_work do
              
              end barber_work;                      
               
               
             
               
                        
               
           
           end loop;
      
   end BShop;     
      
  ---------------------- 
  
  
  
   task Mutex is
      entry free;
      entry take (data : out integer);
            
   end Mutex;


   task body Mutex is
      L: integer;      
      begin
       L:=1;    
       loop
       
              select
     
                  accept take (M : out integer) do
             Put_Line("call Take");
             M:=L;
             Put_Line(" LMTX = " & Integer'Image(L));
                       L:=0;
           end take;
                
              or
           
           accept free do
             Put_Line("call Free");
                       if (l = 1)
                       then Put_Line("call Free, but already free");
                       end if;
             L:=1;          
          end free;
             
              end select;
       end loop;
   end Mutex;

    
  -----------------------------------------------------
  
  task Queue is
      entry free;
      entry take (data : out integer);
            
   end Queue;


   task body Queue is
      L: integer;      
      begin
       L:=1;    
       loop
       
              select
     
                  accept take (M : out integer) do
             Put_Line("call Take");
             M:=L;
             Put_Line(" LMTX = " & Integer'Image(L));
                       L:=0;
           end take;
                
              or
           
           accept free do
             Put_Line("call Free");
                       if (l = 1)
                       then Put_Line("call Free, but already free");
                       end if;
             L:=1;          
          end free;
             
              end select;
       end loop;
   end Queue;

    
  -----------------------------------------------------

begin
    
   Put_Line("Hello, world!");
   
      

end P01;